<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Wuer">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Wuer">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wuer">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Wuer</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Wuer</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/04/搭建服务器/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/04/搭建服务器/" itemprop="url">搭建服务器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-04T09:32:34+08:00">
                2018-12-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="http-server"><a href="#http-server" class="headerlink" title="http-server"></a>http-server</h2><p>使用 http-server node工具启动一个静态服务器</p>
<p>在终端输入 http-server, 就可以启动一个静态服务器</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-6eb68a207ed910b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>接下来就可以用<a href="http://127.0.0.1:8081" target="_blank" rel="noopener">http://127.0.0.1:8081</a> 查看对应的页面了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-90e8637502a4390b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>假设简单页面开发，需要测试时，接口可以做成一个文件，叫’/login.json’。</p>
<p>相当于向文件发送请求，然后会返回文件的内容，您把数据的响应内容放到文件里面就可以了，这样的话可以做一个数据的模拟,整个流程就可以跑通</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'/login.json'</span>,<span class="literal">true</span>)</span><br></pre></td></tr></table></figure>
<p>假设要做一个网易云音乐</p>
<p>1､首先第一个需要做的，就是要获取它的分类 ‘/catelog.json’</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'/catelog.json'</span>,<span class="literal">true</span>)</span><br></pre></td></tr></table></figure>
<p>2､然后接下来在当前的html对应的目录下新建catelog.json文件,里面的内容是就是我们的分类的数据，是json格式的数据。把当前html文件和catelog.json文件放同一级目录,这时把代码上传到githubpages或其他静态服务器后，这功能就有了，当向’/catelog.json’接口发请求，就能得到数据，不需要任何的后台或平台就可以得到数据了</p>
<h5 id="GitHubPages-mock数据"><a href="#GitHubPages-mock数据" class="headerlink" title="GitHubPages mock数据"></a>GitHubPages mock数据</h5><p>1､我们首先需要在同一级目录下新建html和json文件，即song.html和song.json文件，如下图</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-6ddd6296ae6cecc2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>song.html页面代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">var xhr = new XMLHttpRequest()</span></span><br><span class="line"><span class="regexp">xhr.open('GET','/</span>testmusic/song.json<span class="string">',true)</span></span><br><span class="line"><span class="string">//song.json前一定要加'</span>/testmusic<span class="string">'，因为域名是github.com</span></span><br><span class="line"><span class="string">xhr.send()</span></span><br><span class="line"><span class="string">xhr.onload = function()&#123;</span></span><br><span class="line"><span class="string">    console.log(JSON.parse(xhr.responseText))</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br></pre></td></tr></table></figure>
<p>song.json页面代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&quot;90后&quot;,&quot;80后&quot;,&quot;哈哈&quot;]</span><br></pre></td></tr></table></figure>
<p>2､ 设置下，使用githubpages ,做一个预览</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-adb68a2c5dc9e969.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>3､打开这个页面song.html</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-d8668c9c73d22044.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>4、就获取到数据啦<br><img src="https://upload-images.jianshu.io/upload_images/9375265-6514b129b355b5d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="server-mock"><a href="#server-mock" class="headerlink" title="server-mock"></a>server-mock</h2><p>使用 server-mock node工具启动一个能处理静态文件和动态路由的服务器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">switch</span>()&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'getWeather'</span>:</span><br><span class="line">        	res.end(<span class="built_in">JSON</span>.stringify(&#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;))</span><br><span class="line">    		<span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">'/user/123'</span>:</span><br><span class="line">        	res.end(fs.readFileSync(__dirname + <span class="string">'/static/user.tpl'</span>))</span><br><span class="line">    		<span class="keyword">break</span>;</span><br><span class="line">    	<span class="keyword">default</span>:</span><br><span class="line">    		res.end(fs.readFileSync(__dirname + <span class="string">'/static'</span> + req.url))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="手写一个服务器"><a href="#手写一个服务器" class="headerlink" title="手写一个服务器"></a>手写一个服务器</h2><p>可参照    <a href="https://github.com/jirengu/node-server&gt;" target="_blank" rel="noopener">https://github.com/jirengu/node-server&gt;</a></p>
<h2 id="线上mock-数据"><a href="#线上mock-数据" class="headerlink" title="线上mock 数据"></a>线上mock 数据</h2><ol>
<li>使用 <a href="http://easy-mock.com/" target="_blank" rel="noopener">http://easy-mock.com/</a></li>
<li>使用 <a href="http://rapapi.org/org/index.do" target="_blank" rel="noopener">http://rapapi.org/org/index.do</a></li>
<li>使用 server-mock</li>
</ol>
<h5 id="简单来说说easymock"><a href="#简单来说说easymock" class="headerlink" title="简单来说说easymock"></a>简单来说说easymock</h5><p>1､首先进去网页，第一次进来是没有注册的， 直接用户名和密码登录就好</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-78d009374f69f80f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>登录后，开始建立项目</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-62dbea526fe12bad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-aea63812e30e43d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>点创建钮后，就建立了一个项目</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-f304db7c6a9441f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>接下来，点击红框处</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-565fe2d5b3800058.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>开始建立接口啦</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-3e71f3de6a47e939.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>填写相关信息</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-401e59f2b71fa887.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>接口创建好</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-d06052f578ab903e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>现在来编辑，点上图操作下方的第二个小标，进入编辑页面,编辑好并预览</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-55f6f7113317b4e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>点预览,显示结果是</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-8e68c5a52d1dc95c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>我们可以复制接口地址在终端，用命令curl查看结果</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-5385b986fe213471.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-23e8ef9ad7276688.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>我们也可以在本地测试这个接口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'https://easy-mock.com/mock/5c0614d154d29d7973e87912/getType'</span>,<span class="literal">true</span>)</span><br><span class="line">xhr.send()</span><br><span class="line"></span><br><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(xhr.status &gt;=<span class="number">200</span> &amp;&amp; xhr.status &lt;<span class="number">300</span> || xhr.status === <span class="number">304</span>)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(xhr.responseText)</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打开静态服务器，终端输入http-server,然后浏览器预览，结果为</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-2683acdc53ca1627.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>换句话说，我们发了请求的接口，可以是我们之前线上easymock定义的接口，可以定义好接口人，名字,数据，这样子，不管在服务器上还是在本地，都可以做一个演示</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/25/nodejs实现静态服务器/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/25/nodejs实现静态服务器/" itemprop="url">nodejs实现静态服务器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-25T22:30:00+08:00">
                2018-11-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>看了一天的nodejs 实现静态服务器 ,还是晕乎乎，费话不说了，直接上代码，记笔记吧！</p>
<p>首先是页面index.js代码如下：</p>
<h5 id="实例1"><a href="#实例1" class="headerlink" title="实例1"></a>实例1</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># require-----nodejs通过它来加载模块</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>) </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">http是nodejs的内置模块,它是一个对象，然后这个对象提供了一些方法，实现我们所需要的一些功能</span></span><br><span class="line"><span class="comment">整个服务器底层都是由nodejs的http模块实现的</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">函数createServer内部是一个异步的过程,内部会创建一个服务器，创建服务器时里面有一个回调function(req,res),把函数function(req,res)作为对应的参数，来处理我们的请求</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">换句话说，创建服务器后，当浏览器访问这个服务器时,那请求呢，底层会封装成一个对象，这个对象就是第一个参数，是req,可以随便起名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">req 用户请求的信息都在这里，用户的(ip ,访问的域名,浏览器的一些信息)</span></span><br><span class="line"><span class="comment">res 需要返回给用户哪些东西的这个对象</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"># res.write是把数据放到响应体Response里面</span><br><span class="line"># 响应体 是 页面的查看源代码，</span><br><span class="line"># 响应头 是 Response Header</span><br><span class="line"></span><br><span class="line"><span class="comment">//setHeader 设置响应头 </span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'hello world'</span>)</span><br><span class="line">     res.setHeader(<span class="string">"Content-Type"</span>,<span class="string">"text/paint; charset=utf-8"</span>)</span><br><span class="line">     res.write(<span class="string">'&lt;h1&gt; 你好&lt;/h1&gt;'</span>) </span><br><span class="line">     res.end()</span><br><span class="line"> &#125;)</span><br><span class="line"> server.listen(<span class="number">9000</span>) <span class="comment">// listen方法 启动服务器 ,使这个服务器监听 9000端口</span></span><br></pre></td></tr></table></figure>
<h5 id="实例2"><a href="#实例2" class="headerlink" title="实例2"></a>实例2</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>)</span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">/*text/plain 告诉浏览器，你接收到的字符串，你把它当成字符去渲染.  </span></span><br><span class="line"><span class="comment">      text/html 告诉浏览器，你接收到的字符串，你把它当成html去渲染</span></span><br><span class="line"><span class="comment">      charset=utf-8 告诉浏览器，用 utf-8解码</span></span><br><span class="line"><span class="comment">      charset=bgk 告诉浏览器，用 bgk 解码</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    response.setHeader(<span class="string">'Content-Type'</span>,<span class="string">'text/html; charset=utf-8'</span>)</span><br><span class="line">    <span class="comment">//response.writeHead(404, 'Not Found')</span></span><br><span class="line">    response.writeHead(<span class="number">200</span>,<span class="string">'haha'</span>) <span class="comment">// 相当于 状态码 status code</span></span><br><span class="line">    response.write(<span class="string">'&lt;html&gt;&lt;head&gt;&lt;meta charset="gbk" /&gt;&lt;/head&gt;'</span>)</span><br><span class="line">    response.write(<span class="string">'&lt;body&gt;'</span>)</span><br><span class="line">    response.write(<span class="string">'&lt;h1&gt;你好&lt;/h1&gt;'</span>)</span><br><span class="line">    response.write(<span class="string">'&lt;/body&gt;'</span>)</span><br><span class="line">    response.write(<span class="string">'&lt;/html&gt;'</span>)</span><br><span class="line">    </span><br><span class="line">    response.end()</span><br><span class="line">  &#125;,<span class="number">2000</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'open http://localhost:8080'</span>)</span><br><span class="line">server.listen(<span class="number">8080</span>)</span><br></pre></td></tr></table></figure>
<h5 id="接下来是终端"><a href="#接下来是终端" class="headerlink" title="接下来是终端"></a>接下来是终端</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ cd node-server <span class="comment">// 去到对应的目录</span></span><br><span class="line">➜  node-server git:(master) ✗ cd step0</span><br><span class="line">➜  step0 git:(master) ✗ node index.js <span class="comment">//通过node 加上文件名, 启动服务器</span></span><br><span class="line"></span><br><span class="line">如果页面有更改需关闭服务器重新启动，终端操作 ctrl + c 关闭，然后重新启动 node index.js即可!</span><br></pre></td></tr></table></figure>
<p>然后浏览器地址输入如下地址 浏览即可！其中9000是对应的端口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost: <span class="number">9000</span></span><br></pre></td></tr></table></figure>
<h5 id="实例3-实现一个静态服务器"><a href="#实例3-实现一个静态服务器" class="headerlink" title="实例3  实现一个静态服务器"></a>实例3  实现一个静态服务器</h5><p>1､把我们的代码放到static文件夹下,</p>
<p>2､把我们的网站放到远程的机器在上</p>
<p>3､然后通过执行<strong>node server.js</strong> 去运行服务器</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-a85157201549beb2.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="list.jpg"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>) <span class="comment">//创建服务器的模块</span></span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>) <span class="comment">//处理文件路径的模块,自动识别url类型</span></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>) <span class="comment">// 读写文件的 ，读到数据，也可以往文件里写东西</span></span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>) <span class="comment">// 自动解析url 得到一些信息 </span></span><br><span class="line"><span class="comment">/*相当于location, url 作为参数，然后进行解析，得到一个对象,然后我们可以使用里面的某些部分了</span></span><br><span class="line"><span class="comment">不用使用正则去提取啦*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">staticRoot</span>(<span class="params">staticPath,req,res</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(staticPath)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">console</span>.log(req.url)</span><br><span class="line">    <span class="keyword">var</span> pathObj = url.parse(req.url,<span class="literal">true</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(pathObj)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">if(pathObj.pathname === '/')&#123;</span></span><br><span class="line"><span class="comment">    pathObj.pathname += 'index.html'</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">index.html 作为默认的</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> filePath = path.join(staticPath,pathObj.pathname)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 同步读文件</span></span><br><span class="line"><span class="comment">var fileContent = fs.readFileSync(filePath,'binary')</span></span><br><span class="line"><span class="comment">res.write(fileContent,'binary')</span></span><br><span class="line"><span class="comment">res.end()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//异步读文件</span></span><br><span class="line">fs.readFile(filePath,<span class="string">'binary'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,fileContent</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'404'</span>)</span><br><span class="line">        res.writeHead(<span class="number">404</span>,<span class="string">'not find'</span>)</span><br><span class="line">        res.end(<span class="string">'&lt;h1&gt; 404 Not Found'</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">'ok'</span>)</span><br><span class="line">       res.writeHead(<span class="number">200</span>,<span class="string">'ok'</span>)</span><br><span class="line">       res.write(fileContent,<span class="string">'binary'</span>)</span><br><span class="line">       res.end()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(path.join(__dirname,<span class="string">'static'</span>))</span><br><span class="line"><span class="comment">//__dirname：当前模块的文件夹名称，nodejs内置的变量，代表当前代码的server.js的文件夹路径。也就是step1的绝对路径,然后拼上static路径，最终static的绝对路径</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    staticRoot(path.join(__dirname,<span class="string">'static'</span>),req,res)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">8080</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'visit http://localhost:8080'</span>)</span><br></pre></td></tr></table></figure>
<p>__dirname 请参照 <a href="http://nodejs.cn/api/modules.html#modules_dirname" target="_blank" rel="noopener">http://nodejs.cn/api/modules.html#modules_dirname</a></p>
<p>总结如下简图</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-3999c2e18dac389d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="pic.jpg"></p>
<p>用户的浏览器随便输入一个URL，<a href="http://localhost:8080/a/b/c" target="_blank" rel="noopener">http://localhost:8080/a/b/c</a> </p>
<p>这时浏览器会把这个请求向这个域名<a href="http://localhost:8080对应的IP去发送" target="_blank" rel="noopener">http://localhost:8080对应的IP去发送</a></p>
<p>发完之后这个请求从左边浏览器到了右边的远程机器上</p>
<p>然后根据端口进行匹配,匹配上后，交给某个服务器</p>
<p>这个服务器就拿到了这个请求,一个请求可以当成一个对象,对象里有关于这个请求的信息</p>
<p>拿到之后，在服务器里进行处理,处理好之后，把结果再从服务器发回浏览器,就行了</p>
<p>发回去分为两部分，一个是响应头，一个是响应体</p>
<p>来一个简单版的静态服务器 server-simple.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(__dirname + <span class="string">'/static'</span> + req.url)</span><br><span class="line">    <span class="comment">// 当一个请求到来时，通过当前的目录（__dirname）step1,加上'/static'，再加上'req.url',拼装成一个完整的路径</span></span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> fileContent = fs.readFileSync(__dirname + <span class="string">'/static'</span> + req.url)</span><br><span class="line">        <span class="comment">// 然后去读这个文件,读完之后，得到结果</span></span><br><span class="line">        res.write(fileContent) <span class="comment">// 得到结果之后，再把结果发出去 </span></span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        res.writeHead(<span class="number">404</span>,<span class="string">'not found'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    res.end()</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">8080</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'visit http://localhost:8080'</span>)</span><br></pre></td></tr></table></figure>
<p>如需要nodejs 服务器 路由解析 上面代码改为：</p>
<p>// 其中路由是指域名后边的东西 如：localhost:8080/user/123 中的 ‘/user/123’</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">switch</span>(req.url)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'getWeather'</span>:</span><br><span class="line">        	res.end(<span class="built_in">JSON</span>.stringify(&#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;))</span><br><span class="line">        	<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'user/123'</span>:</span><br><span class="line">        	res.end(fs.readFileSync(__dirname + <span class="string">'/static/user.tpl'</span>))</span><br><span class="line">        	<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">        	res.end(fs.readFileSync(__dirname + <span class="string">'/static'</span> + req.url))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).listen(<span class="number">8080</span>)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/19/ajax/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/19/ajax/" itemprop="url">ajax</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-19T17:25:20+08:00">
                2018-11-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="什么是ajax-异步的Javascript-and-XML"><a href="#什么是ajax-异步的Javascript-and-XML" class="headerlink" title="什么是ajax. (异步的Javascript and XML)"></a>什么是ajax. (异步的Javascript and XML)</h4><p>Ajax 是一种技术方案，但并不是一种新技术。它依赖的是现有的CSS/HTML/Javascript,而其中最核心的依赖是浏览器提供的XMLHttpRequest对象，是这个对象使得浏览器可以发出HTTP请求与接收HTTP响应。实现在页面不刷新的情况下和服务端进行数据交互。</p>
<p>一句话总结：我们使用<code>XMLHttpRequest</code>对象来发送一个<code>Ajax</code>请求</p>
<h5 id="来一个简易版实例（写一个ajax）"><a href="#来一个简易版实例（写一个ajax）" class="headerlink" title="来一个简易版实例（写一个ajax）"></a>来一个简易版实例（写一个ajax）</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()<span class="comment">//建立对象</span></span><br><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'/hello.json'</span>,<span class="literal">true</span>)</span><br><span class="line"><span class="comment">//创建一个GET请求，采用异步,true表示异步，异步代表需要绑定一个事件</span></span><br><span class="line"><span class="comment">// "/hello.json"表示域名+/hello.json,如果http-server打开静态服务器，127.0.0.1:8080/hello.json</span></span><br><span class="line">xhr.send()<span class="comment">//发送请求</span></span><br><span class="line">xhr.addEventListener(<span class="string">'load'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">var</span> data = xhr.responseText</span><br><span class="line">       <span class="built_in">console</span>.log(data)    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如果是同步请求的话，代码是这样子的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'/hello.json'</span>,<span class="literal">false</span>) <span class="comment">//设置参数，false表示同步</span></span><br><span class="line">xhr.send()</span><br><span class="line"><span class="keyword">var</span> data = xhr.responseText</span><br><span class="line"><span class="built_in">console</span>.log(data)</span><br></pre></td></tr></table></figure>
<h5 id="这里提到了同步和异步，那我们稍稍说解下"><a href="#这里提到了同步和异步，那我们稍稍说解下" class="headerlink" title="这里提到了同步和异步，那我们稍稍说解下"></a>这里提到了同步和异步，那我们稍稍说解下</h5><p><strong>同步：</strong> 我发了一个请求，然后属于等待中，就卡死啦,这个时候只有后端给我响应之后，我才可以继续操作,代码才能继续往下执行</p>
<p>就相当于我在算一个很复杂的数据，花了5分钟一样，在5分钟内一直属于算的状态，所以后面的js 是不执行的,是卡死状态</p>
<p><strong>异步：</strong> 我发了一个请求，我就不管了，然后我会去监听我的某一个状态,当状态发生改变时，也就是说达到我的一个需求时或是满足我的条件时,那我再去做一个事情</p>
<p>像这些就是异步：</p>
<p><strong>1､点击事件</strong></p>
<p>绑定一个事件后，我就不管了,就不去执行它,什么时侯去执行呢</p>
<p>当达到某一个条件（用户去点击，或是用户去点击去触发那个事件时）</p>
<p>那我才去执行它</p>
<p><strong>2､setTimeout</strong></p>
<p>绑定一个函数后，它不执行,什么时侯去执行呢</p>
<p>当这个时间点到了之后，浏览器内部会发出一个事件（时间到了的这个事件），去执行它</p>
<p><strong>3､ajax </strong></p>
<p>也是一样的，我的请求发出去之后，就先不去管了，什么时候去执行呢</p>
<p>当我这里面内部状态发生改变的时侯，我监听到了，我觉得该去处理了，我就去处理它</p>
<h5 id="进一步完善"><a href="#进一步完善" class="headerlink" title="进一步完善"></a>进一步完善</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'/hello.json'</span>,<span class="literal">true</span>)</span><br><span class="line">xhr.send()</span><br><span class="line"></span><br><span class="line"><span class="comment">//readystate的change事件</span></span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(xhr.readystate === <span class="number">4</span> &amp;&amp; xhr.status === <span class="number">200</span>)&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(xhr.responsText)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// xhr.readystate 它的交互流程是否完毕，有没结束</span></span><br><span class="line"><span class="comment">// xhr.status 服务器的状态 表示数据是否ok,是否正常</span></span><br><span class="line"></span><br><span class="line">xhr.addEventListener(<span class="string">'readystatechange'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'readystate:'</span>,xhr.readyState)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//load是 readyState变为4时，会自动触发load,所以我们不用管readyState ，直接写onload, 表示 readyState是4啦</span></span><br><span class="line">xhr.addEventListener(<span class="string">'load'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(xhr.status)</span><br><span class="line">    <span class="keyword">if</span>(xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span> || xhr.status === <span class="number">304</span>)&#123;</span><br><span class="line">       <span class="keyword">var</span> data = xhr.responseText</span><br><span class="line">       <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'error'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="最后完善："><a href="#最后完善：" class="headerlink" title="最后完善："></a>最后完善：</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.open(<span class="string">'GET'</span>, <span class="string">'/hello.json'</span>, <span class="literal">true</span>)</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(xhr.readyState === <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>((xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>) || xhr.status == <span class="number">304</span>)&#123;</span><br><span class="line">            <span class="comment">//成功了</span></span><br><span class="line">            <span class="built_in">console</span>.log(xhr.responseText)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'服务器异常'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">xhr.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'服务器异常'</span>)</span><br><span class="line">&#125;</span><br><span class="line">xhr.send()</span><br></pre></td></tr></table></figure>
<h5 id="换种写法"><a href="#换种写法" class="headerlink" title="换种写法"></a>换种写法</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.open(<span class="string">'GET'</span>, <span class="string">'hello.json'</span>, <span class="literal">true</span>)</span><br><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>) || xhr.status == <span class="number">304</span>)&#123;</span><br><span class="line">        <span class="comment">//成功了</span></span><br><span class="line">        <span class="built_in">console</span>.log(xhr.responseText)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'服务器异常'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">xhr.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'服务器异常'</span>)</span><br><span class="line">&#125;</span><br><span class="line">xhr.send()</span><br></pre></td></tr></table></figure>
<p>a、GET形式的数据请求 (<strong>数据拼装成url形式</strong>)</p>
<p>准确地说是传递参数(username、password)  把数据拼装成url形式,放到?后面】</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'/login?username=xwu&amp;password=123'</span>,<span class="literal">true</span>)</span><br><span class="line">xhr.send()</span><br><span class="line"></span><br><span class="line"><span class="comment">//readystate的change事件</span></span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(xhr.readystate === <span class="number">4</span> &amp;&amp; xhr.status === <span class="number">200</span>)&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(xhr.responsText)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// xhr.readystate 它的交互流程是否完毕，有没结束</span></span><br><span class="line"><span class="comment">// xhr.status 服务器的状态 表示数据是否ok,是否正常</span></span><br><span class="line"></span><br><span class="line">xhr.addEventListener(<span class="string">'readystatechange'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'readystate:'</span>,xhr.readyState)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//load是 readyState变为4时，会自动触发load,所以我们不用管readyState ，直接写onload, 表示 readyState是4啦</span></span><br><span class="line">xhr.addEventListener(<span class="string">'load'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(xhr.status)</span><br><span class="line">    <span class="keyword">if</span>(xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span> || xhr.status === <span class="number">304</span>)&#123;</span><br><span class="line">       <span class="keyword">var</span> data = xhr.responseText</span><br><span class="line">       <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'error'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>b、POST形式数据请求 (<strong>直接发送数据</strong>)</p>
<p>准确地说是不会把数据拼装成url形式,而是把数据拼好了放到send里面。当然数据拼接的过程可以写一个函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.open(<span class="string">'POST'</span>,<span class="string">'/login'</span>,<span class="literal">true</span>)</span><br><span class="line"><span class="comment">//xml.send('username=xwupassword=123')</span></span><br><span class="line">xhr.send(makeUrl(&#123;</span><br><span class="line">	username: <span class="string">'xwu'</span>,</span><br><span class="line">	age: <span class="number">2</span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">xhr.addEventListener(<span class="string">'load'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(xhr.status)</span><br><span class="line">	<span class="keyword">if</span>((xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>) || xhr.status === <span class="number">304</span>)&#123;</span><br><span class="line">	<span class="keyword">var</span> data = xhr.responseText</span><br><span class="line">		<span class="built_in">console</span>.log(data)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'error'</span>)			</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">xhr.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'error'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">makeUrl(&#123;</span><br><span class="line">	username: <span class="string">'xwu'</span>,</span><br><span class="line">	age: <span class="number">2</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeUrl</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> arr = []</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj)&#123;</span><br><span class="line">		arr.push(key + <span class="string">'='</span> + obj[key])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> arr.join(<span class="string">'&amp;'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="封装一个ajax"><a href="#封装一个ajax" class="headerlink" title="封装一个ajax"></a>封装一个ajax</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">opts</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> url = opts.url</span><br><span class="line">    <span class="keyword">var</span> type = opts.type || <span class="string">'GET'</span></span><br><span class="line">    <span class="keyword">var</span> dataType = opts.dataType || <span class="string">'json'</span></span><br><span class="line">    <span class="keyword">var</span> onsuccess = opts.onsuccess || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">var</span> onerror = opts.onerror || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">var</span> data = opts.data || &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> dataStr = []</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> data)&#123;</span><br><span class="line">        dataStr.push(key + <span class="string">'='</span> + data[key])</span><br><span class="line">    &#125;</span><br><span class="line">    dataStr = dataStr.join(<span class="string">'&amp;'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(type === <span class="string">'GET'</span>)&#123;</span><br><span class="line">        url += <span class="string">'?'</span> + dataStr</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">    xhr.open(type, url, <span class="literal">true</span>)</span><br><span class="line">    xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>((xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>) || xhr.status == <span class="number">304</span>)&#123;</span><br><span class="line">            <span class="comment">//成功了</span></span><br><span class="line">            <span class="keyword">if</span>(dataType === <span class="string">'json'</span>)&#123;</span><br><span class="line">                onsuccess( <span class="built_in">JSON</span>.parse(xhr.responseText))</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                onsuccess( xhr.responseText)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            onerror()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.onerror = onerror</span><br><span class="line">    <span class="keyword">if</span>(type === <span class="string">'POST'</span>)&#123;</span><br><span class="line">        xhr.send(dataStr)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        xhr.send()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ajax(&#123;</span><br><span class="line">    url: <span class="string">'http://api.jirengu.com/weather.php'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        city: <span class="string">'北京'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    onsuccess: <span class="function"><span class="keyword">function</span>(<span class="params">ret</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(ret)</span><br><span class="line">    &#125;,</span><br><span class="line">    onerror: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'服务器异常'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="可参考-https-segmentfault-com-a-1190000004322487"><a href="#可参考-https-segmentfault-com-a-1190000004322487" class="headerlink" title="可参考  https://segmentfault.com/a/1190000004322487"></a>可参考  <a href="https://segmentfault.com/a/1190000004322487" target="_blank" rel="noopener">https://segmentfault.com/a/1190000004322487</a></h5>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/18/cookie、session、localStorage/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/18/cookie、session、localStorage/" itemprop="url">cookie、session、localStorage</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-18T16:35:39+08:00">
                2018-11-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="一、cookie-："><a href="#一、cookie-：" class="headerlink" title="一、cookie ："></a>一、cookie ：</h4><p>1、存储在浏览器上的一小段数据，用来记录某些当页面关闭或刷新后仍然需要记录的信息。在控制台用 document.cookie 查看你当前正在浏览的网站的cookie</p>
<p>2、可以使用js 在浏览器直接设置（用于记录不敏感信息，如用户名),也可 以在服务端使用HTTP协议规定的set-cookie来让浏览器种下cookie,这是最常见的做法。（打开一个网站，清除全部cookie, 然后刷新页面，在network的Response headers 试试找一找set-cookie吧）</p>
<p>3、每次网络请求Request headers中都会带上cookie. 所以如果cookie 太多太大对传输效率会有影响。</p>
<p>4、一般浏览器存储cookie 最大容量为4k,所以大量数据不要存到cookie。</p>
<p>5、设置cookie时的参数：</p>
<p>a、path: 表示cookie影响到的路径，匹配该路径才发送这个cookie。expires和maxAge: 告诉浏览器cookie时候过期，maxAge是cookie多久后过期的相对时间。不设置这两个选项时会产生session cookie，session cookie 是transient的，当用户关闭浏览器时，就被清除。一般用来保存session 的 session 的 session_id。</p>
<p>b、secure：当secure值为true时，cookie在HTTP中是无效，在HTTPS中才有效</p>
<p>c、httpOnly：浏览器不允许脚本操作document.cookie去更改cookie。一般情况下都应该设置这个为true。这样可以避免被xss 攻击拿到 cookie。</p>
<h4 id="二、session"><a href="#二、session" class="headerlink" title="二、session"></a>二、session</h4><p>当一个用户打开淘宝登录后，刷新浏览器仍然展示登录状态。服务器如何分辨这次发起请求的用户是刚才登录过的用户呢？这时就使用了session保存状态。用户在输入用户名密码提交给服务端，服务端验证通过后会创建一个session用于记录用户的相关信息。这个session可保存在服务器内存中，也可保存在数据库中。</p>
<ul>
<li>创建session后，会把关联的session_id通过setCookie添加一http响应头部中。</li>
<li>浏览器在加载页面时发现响应头部有set-cookie字段，就把这个cookie种到浏览器指定域名中。</li>
<li>当下次刷新页面时，发送的请求会带上这条cookie,服务端在接收到后根据这个session_id来识别用户。</li>
</ul>
<p>cookie是存储在浏览器里的一小段数据，而session是一种让服务器能识别某个用户的机制，session在实现的过程中需要使用cookie。二者不是同一维度的东西。</p>
<h4 id="三、localStorage"><a href="#三、localStorage" class="headerlink" title="三、localStorage"></a>三、localStorage</h4><p>1､ localStorage HTML5本地存储web storage 特性之一，用于将大量数据（最大5M）保存在浏览器中，保存后数据永远不会失效过期，除非用js 手动清除。</p>
<p>2､ 不参与网络传输</p>
<p>3､一般用于性能优化，可以保存图片、js、css、html模板、大量数据</p>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p>sessionStorage、localStorage是HTML5提供的Web Storage API提供的，可以避免数据在浏览器和服务器之间不必要的来回传递。  sessionStorage、 localStorage 、 cookie 都是在浏览器端存储的数据。  </p>
<p>三者之间的区别： </p>
<h5 id="cookie"><a href="#cookie" class="headerlink" title="cookie:"></a>cookie:</h5><p>1､每个域名的存储量有限（一般是4k）      </p>
<p>2､所有域名的存储量有限  </p>
<p>3､会跟随请求被发送到服务器上  </p>
<p>4､有个数限制，不同浏览器下，一个域名下cookie的个数有限，并且限制数量可能不一样  </p>
<h5 id="sessionStorage"><a href="#sessionStorage" class="headerlink" title="sessionStorage:"></a>sessionStorage:</h5><p>1､当浏览器窗口关闭的时候， sessionStorage 就会被销毁  </p>
<p>2､存储容量大(一般比localStorage的存储容量大)  </p>
<h5 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage:"></a>localStorage:</h5><p>1､在客户端永久保存  </p>
<p>2､单个域名的存储容量大(一般为5M)  </p>
<p>3､总体数量无限制</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/15/事件传播机制、阻止传播、取消默认事件、事件代理/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/15/事件传播机制、阻止传播、取消默认事件、事件代理/" itemprop="url">事件传 播机制、阻止传播、取消默认事件、事件代理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-15T18:07:57+08:00">
                2018-11-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="事件是某个行为或者触发，比如点击、鼠标移动："><a href="#事件是某个行为或者触发，比如点击、鼠标移动：" class="headerlink" title="事件是某个行为或者触发，比如点击、鼠标移动："></a>事件是某个行为或者触发，比如点击、鼠标移动：</h3><ul>
<li>当用户点击鼠标时</li>
<li>当网页已加载时</li>
<li>当图像已加载时</li>
<li>当鼠标移动到元素上时</li>
<li>当用户触发按键时</li>
</ul>
<h3 id="事件流"><a href="#事件流" class="headerlink" title="事件流"></a>事件流</h3><ul>
<li>事件冒泡</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-8c25303fd6a8ae6c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="事件冒泡.jpg"></p>
<p>事件开始时由最具体的元素接受，然后逐级向上传播到较为不具体的元素</p>
<ul>
<li><p>事件捕获</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-932479cb12a7d34f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="事件捕获.jpg"></p>
<p>不太具体的节点更早接受事件，而最具体的元素最后接受事件，和事件冒泡相反</p>
</li>
<li><p>DOM事件流</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-c22e82b87f4f98dd.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="DOM事件流.jpg"></p>
<p>DOM2级事件规定事件流包括三个阶段，事件捕获阶段，处于目标阶段，时间冒泡阶段，首先发生的是事件捕获，为截取事件提供机会，然后是实际目标接受事件，最后是冒泡阶段</p>
</li>
</ul>
<p><em>注</em>：Opera、Firefox、Sarfari都支持DOM事件流，IE不支持事件流，只支持时间冒泡</p>
<h2 id="阻止传播"><a href="#阻止传播" class="headerlink" title="阻止传播"></a>阻止传播</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stopPropagation()</span><br></pre></td></tr></table></figure>
<h3 id="定义和用法"><a href="#定义和用法" class="headerlink" title="定义和用法"></a>定义和用法</h3><p>不再派发事件。<br> 终止事件在传播过程的捕获、目标处理或起泡阶段进一步传播。调用该方法后，该节点上处理该事件的处理程序将被调用，事件不再被分派到其他节点。</p>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>该方法将停止事件的传播，阻止它被分派到其他 Document 节点。在事件传播的任何阶段都可以调用它。注意，虽然该方法不能阻止同一个 Document 节点上的其他事件句柄被调用，但是它可以阻止把事件分派到其他节点。</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event.stopPropagation()</span><br></pre></td></tr></table></figure>
<p>注意： IE浏览器的后面几个版本都 支持了W3C标准，之前有个别版本不支持<br> event在IE不支持的版本中，是无法接收到事件的，并且没有<code>stopProgapation</code>方法<br> 火狐、google及最新的IE版本的结束事件都支持<code>stopPropagation()</code>方法来结束默认行为<br> 老版本的IE如想结束默认行为，须要使用<code>window.event.cancelBubble = true;</code>方法</p>
<h2 id="取消默认事件"><a href="#取消默认事件" class="headerlink" title="取消默认事件"></a>取消默认事件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preventDefault() 方法</span><br></pre></td></tr></table></figure>
<p>什么是事件默认行为?</p>
<ul>
<li>a链接默认跳转</li>
<li>type =submit默认提交表单</li>
<li>其他浏览器默认行为…</li>
</ul>
<h3 id="定义和用法-1"><a href="#定义和用法-1" class="headerlink" title="定义和用法"></a>定义和用法</h3><p><code>preventDefault()</code> 方法阻止元素发生默认的行为（例如，当点击提交按钮时阻止对表单的提交）。</p>
<p>示例: 阻止a链接进行跳转，并输出a链接</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">  &lt;title&gt;JS Bin&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">   &lt;a href=<span class="string">"http://baidu.com"</span>&gt;百度&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">&lt;script type="text/</span>javascript<span class="string">"&gt;</span></span><br><span class="line"><span class="string">   document.querySelector('a').onclick = function(e) &#123;</span></span><br><span class="line"><span class="string">     e.preventDefault()</span></span><br><span class="line"><span class="string">     console.log(this.href)</span></span><br><span class="line"><span class="string">   &#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="事件代理"><a href="#事件代理" class="headerlink" title="事件代理"></a>事件代理</h2><p>由于事件会在冒泡阶段向上传播到父节点，因此可以把子节点的监听函数统一处理多个子元素的事件，这种方法叫做事件的代理。</p>
<p>定义：事件代理就是利用事件冒泡，只指定一个事件处理程序，就可以管理某一类型的所有事件。</p>
<p>试想一下:假设公司里每次收快递的时候员工都跑到公司门口去收自己的快递,如果同时多个人也同样去收自己快递这样公司就秩序混轮了!如果委托给前台妹子去收快递然后由妹子去派发快递这个过程就叫委托事件!(备注:冒泡思想也有点相仿只不过是由父节点往子节点传递信息)。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ul = <span class="built_in">document</span>.querySelector(<span class="string">'ul'</span>);</span><br><span class="line">ul.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(event.target.tagName.toLowerCase() === <span class="string">'li'</span>)&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>上面代码的<code>click</code>事件的监听函数定义在<code>&lt;ul&gt;</code>节点，但是实际上，它处理的是子节点<code>&lt;li&gt;</code>的<code>click</code>事件。</p>
<h3 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h3><p>1.定义一个监听函数，就能处理多个子节点的事件。比如ul上代理所有li的click事件就很不错。<br> 2.可以实现当新增子对象时，无需再对其进行事件绑定，监听函数依然有效，对于动态内容部分尤为合适</p>
<h3 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h3><p>事件代理的常用应用应该仅限于上述需求，如果把所有事件都用事件代理，可能会出现事件误判。即本不该被触发的事件被绑定上了事件。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/14/onclick与addEventListener区别/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/14/onclick与addEventListener区别/" itemprop="url">onclick与addEventListener区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-14T15:04:18+08:00">
                2018-11-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>addEventListener和onclick有什么不一样？于是Google查了下，稍微整理了下：</p>
<ul>
<li><p>onclick 只能绑定一个事件，绑定多个会产生覆盖；不能设置参数，使用默认的事件冒泡阶段。</p>
</li>
<li><p>addEventListener中有第3个参数，attachEvent没有。第3个参数传递的是false或true。这个参数可选，默认是false。<br> false–表示事件处理将在冒泡阶段执行。<br> true–表示事件处理将在捕获阶段执行。</p>
</li>
<li><p>理论上，Event Listeners (addEventListener、attachEvent（IE使用 ）)可以无限增加事件监听给某个一元素。实际应用的约束就是客户端内存的限制，这一点因每个浏览器而异。</p>
</li>
</ul>
<p><strong>onclick</strong> 属性返回当前元素的 <code>click</code> 事件处理器代码</p>
<p>语法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.onclick = functionRef;</span><br></pre></td></tr></table></figure>
<p><em>functionRef</em> 是一个函数：通常是在别处声明的函数名或者是一个函数表达式（<em>function expression</em>）</p>
<p><strong>来个实例：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul id = <span class="string">"list"</span>&gt;</span><br><span class="line"> &lt;li id = <span class="string">"add_event"</span>&gt;white&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp"> &lt;li id = "on_click"&gt;black&lt;/</span>li&gt;</span><br><span class="line">&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">var on_click = document.getElementById('on_click');</span></span><br><span class="line"><span class="regexp">on_click.onclick = function()&#123;</span></span><br><span class="line"><span class="regexp">    alert('我是click1');</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">on_click.onclick = function()&#123;</span></span><br><span class="line"><span class="regexp">    alert('我是click2');</span></span><br><span class="line"><span class="regexp">&#125; </span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>运行结果：</strong></p>
<p>可想而知，只会弹出一个弹出框(我是 click2)，虽然绑定了两次</p>
<p>一个click处理器在同一时间只能指向唯一的对象。因此就算对于一个对象绑定了多次，但是仍然只会出现最后的一次绑定</p>
<p><strong>addEventListener绑定click事件</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">currentTarget.addEventListener(type,listener,option)</span><br></pre></td></tr></table></figure>
<p><strong>来个实例：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul id = <span class="string">"list"</span>&gt;</span><br><span class="line"> &lt;li id = <span class="string">"add_event"</span>&gt;white&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp"> &lt;li id = "on_click"&gt;black&lt;/</span>li&gt;</span><br><span class="line">&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">var addEvent = document.getElementById('add_event');</span></span><br><span class="line"><span class="regexp">addEvent.onclick = function()&#123;</span></span><br><span class="line"><span class="regexp">    alert('我是addEvent1');</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">addEvent.onclick = function()&#123;</span></span><br><span class="line"><span class="regexp">    alert('我是addEvent2');</span></span><br><span class="line"><span class="regexp">&#125; </span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>运行结果：</strong></p>
<p>两次绑定的事件，都能够成功运行，也就是前后弹出’我是addEvent1’ ‘我是addEvent2’</p>
<p><strong>由此可见，对于一个可以绑定的事件对象，想多次绑定事件都能运行，选用addEventListener</strong></p>
<p>通过addEventListener添加的事件必须通过相对应的为removeListener注销事件。但是如果像上面的用匿名函数的方式注册的事件，不能使用removeListener注销，因为没用对应事件的引用。</p>
<p>所以注册事件如果需要取消，最好使用一个引用，即:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var eventName = function () &#123;</span><br><span class="line">    //something</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也正是这种方式，对于一个对象多次绑定同样的eventName，那么不会重复执行，只会执行一次。对于上面的匿名函数，就算内容一样，也会依次执行，<strong>因为并不能算是相同事件处理器</strong>。</p>
<p>里面的this引用，不是window对象，而是触发事件的元素的引用。</p>
<p>对于IE9之前，相对应的是attachEvent和detachEvent</p>
<p><strong>最后总结：</strong></p>
<ol>
<li><p>onclick事件在同一时间只能指向唯一对象</p>
</li>
<li><p>addEventListener给一个事件注册多个listener</p>
</li>
<li><p>addEventListener对任何DOM都是有效的，而onclick仅限于HTML</p>
</li>
<li><p>addEventListener可以控制listener的触发阶段，（捕获/冒泡）。对于多个相同的事件处理器，不会重复触发，不需要手动使用removeEventListener清除</p>
</li>
<li><p>IE9使用attachEvent和detachEvent</p>
</li>
</ol>
<p>可参考: <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/onclick" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/onclick</a></p>
<p>​             <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/07/任务队列异步函数节流/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/07/任务队列异步函数节流/" itemprop="url">任务队列异步函数节流</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-07T17:17:57+08:00">
                2018-11-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先我们来了解下单线程和任务队列</p>
<h5 id="单线程："><a href="#单线程：" class="headerlink" title="单线程："></a>单线程：</h5><p>只有一条线，一步一步走，即所有任务都需要排队，前一个任务完成，才会执行后一个任务, 如果前一个任务时间耗时长，后一个任务就不得不一直等着</p>
<h5 id="任务队列："><a href="#任务队列：" class="headerlink" title="任务队列："></a>任务队列：</h5><p>在JavaScript中任务有两种，一种是同步任务，一种是异步任务。</p>
<p>同步任务：各个任务按照文档定义的顺序一一推入”执行栈”中，当前一个任务执行完毕，才会开始执行下一个任务。</p>
<p>异步任务：各个任务推入”任务队列”中，只有在当前的所有同步任务执行完毕，才会将队列中的任务”出队”执行。</p>
<p>当线程中没有执行任何同步代码的前提下才会执行异步代码</p>
<p>如下实例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    a = <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">var</span> a ;</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line">a = <span class="number">3</span>;</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"></span><br><span class="line">输出结果是</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line">分析：</span><br><span class="line">setTimeout异步执行，从上到下执行完之后再执行setTimeout内的语句</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>；声明并将<span class="number">1</span>赋值给a</span><br><span class="line">setTimeout方法加入任务队列不执行</span><br><span class="line"><span class="keyword">var</span> a ；声明a a的值不变</span><br><span class="line"><span class="built_in">console</span>.log(a) ；输出为 <span class="number">1</span></span><br><span class="line">a = <span class="number">3</span> ；将<span class="number">3</span>赋值给a</span><br><span class="line"><span class="built_in">console</span>.log(a) ；输出为<span class="number">3</span></span><br><span class="line">执行setTimeout，a被赋值为<span class="number">2</span>并即时输出</span><br></pre></td></tr></table></figure>
<h6 id="再来一个实例"><a href="#再来一个实例" class="headerlink" title="再来一个实例"></a>再来一个实例</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> flag = <span class="literal">true</span>;</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    flag = <span class="literal">false</span>;</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br><span class="line"><span class="keyword">while</span>(flag)&#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(flag);</span><br><span class="line"></span><br><span class="line">不输出任何东西，且控制台/浏览器卡死</span><br><span class="line">分析：</span><br><span class="line"><span class="keyword">var</span> flag = <span class="literal">true</span>，给flag赋值</span><br><span class="line">遇到setTimeout，加入任务队列，跳过</span><br><span class="line"> <span class="keyword">while</span>语句，这里的flag是<span class="literal">true</span>，执行&#123;&#125;内循环体，循环体没有内容，一直死循环</span><br></pre></td></tr></table></figure>
<h5 id="函数节流原理"><a href="#函数节流原理" class="headerlink" title="函数节流原理"></a>函数节流原理</h5><p>我们设置一个定时器，一开始判断定时器是不是有了，如果没有的话，再去设置一个定时器，如果有了话，把上一次的清除掉，然后我们再重新设置</p>
<h6 id="如下实例："><a href="#如下实例：" class="headerlink" title="如下实例："></a>如下实例：</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> timer</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(timer)&#123;</span><br><span class="line">        clearTimeout(timer)</span><br><span class="line">    &#125;</span><br><span class="line">    timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'hello'</span>)</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line">test()</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/06/setTimeout用法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/06/setTimeout用法/" itemprop="url">setTimeout用法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-06T23:24:21+08:00">
                2018-11-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h3><p>JS 提供定时执行代码的功能，叫做定时器（timer），主要是由setTimeout() 和 setInterval()两个函数来完成</p>
<h5 id="setTimeout"><a href="#setTimeout" class="headerlink" title="setTimeout()"></a>setTimeout()</h5><p>用来指定某个函数或某段代码，在多少毫秒之后执行。它返回一个整数，表不定时器的编号，以后可以用来取消这个定时器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> timerId = setTimeout(func|code,delay)</span><br></pre></td></tr></table></figure>
<p>上面代码中，setTimeout函数接受两个参数，第一个参数func|code是将要推迟执行的函数名或一段代码，第二个参数delay是推迟执行的毫秒数</p>
<p>setTimeout方法一般总是采用函数名的形式，像这样子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line">setTimeout(f,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">或</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">2</span>)&#125;,<span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<h5 id="setInterval"><a href="#setInterval" class="headerlink" title="setInterval()"></a>setInterval()</h5><p>与setTimeout完全一致，区别在于setInterval指定某个任务每隔一段时间就执行一次，也就是无限次的定时执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> timer = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i++)</span><br><span class="line">&#125;,<span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<p>上面代码表示每隔1000豪秒就输出一个i,直到用户点击了停止按钮</p>
<h5 id="clearTimeout-、clearInterval-可以取消对应的定时器"><a href="#clearTimeout-、clearInterval-可以取消对应的定时器" class="headerlink" title="clearTimeout()、clearInterval() 可以取消对应的定时器"></a>clearTimeout()、clearInterval() 可以取消对应的定时器</h5>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/06/正则表达式/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/06/正则表达式/" itemprop="url">正则表达式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-06T12:28:45+08:00">
                2018-11-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>正则表达式用于匹配字符串字符组合的模式,在JavaScript中，正则表达式也是对象。</p>
<h4 id="匹配将依照下列规则："><a href="#匹配将依照下列规则：" class="headerlink" title="匹配将依照下列规则："></a>匹配将依照下列规则：</h4><h6 id="在非特殊字符之前的反斜杠表示下一个字符是特殊的，不能从字面上解释。"><a href="#在非特殊字符之前的反斜杠表示下一个字符是特殊的，不能从字面上解释。" class="headerlink" title="\  :    在非特殊字符之前的反斜杠表示下一个字符是特殊的，不能从字面上解释。"></a>\  :    在非特殊字符之前的反斜杠表示下一个字符是特殊的，不能从字面上解释。</h6><p>例如，没有前面’\’的’b’通常匹配小写’b’，无论它们出现在哪里。如果加了’\’,这个字符变成了一个特殊意义的字符，意思是匹配一个字符边界。</p>
<p>反斜杠也可以将其后的特殊字符，转义为字面量。例如，模式 /a<em>/ 代表会匹配 0 个或者多个 a。相反，模式 /a\</em>/ 将 ‘<em>‘ 的特殊性移除，从而可以匹配像 “a</em>“ 这样的字符串。</p>
<p>使用 new RegExp(“pattern”) 的时候不要忘记将 \ 进行转义，因为 \ 在字符串里面也是一个转义字符。</p>
<h6 id="匹配输入的开始。如果多行标志被设置为true，那么也匹配换行符后紧跟的位置。"><a href="#匹配输入的开始。如果多行标志被设置为true，那么也匹配换行符后紧跟的位置。" class="headerlink" title="^  :   匹配输入的开始。如果多行标志被设置为true，那么也匹配换行符后紧跟的位置。"></a>^  :   匹配输入的开始。如果多行标志被设置为true，那么也匹配换行符后紧跟的位置。</h6><p>例如，/^A/ 并不会匹配 “an A” 中的 ‘A’，但是会匹配 “An E” 中的 ‘A’。<br>当 ‘^’ 作为第一个字符出现在一个字符集合模式时，它将会有不同的含义</p>
<h6 id="匹配输入的结束。如果多行标示被设置为true，那么也匹配换行符前的位置。"><a href="#匹配输入的结束。如果多行标示被设置为true，那么也匹配换行符前的位置。" class="headerlink" title="$ :  匹配输入的结束。如果多行标示被设置为true，那么也匹配换行符前的位置。"></a>$ :  匹配输入的结束。如果多行标示被设置为true，那么也匹配换行符前的位置。</h6><p>   例如，/t$/ 并不会匹配 “eater” 中的 ‘t’，但是会匹配 “eat” 中的 ‘t’。</p>
<h6 id="匹配前一个表达式0次或多次。等价于-0-。"><a href="#匹配前一个表达式0次或多次。等价于-0-。" class="headerlink" title="* :  匹配前一个表达式0次或多次。等价于 {0,}。"></a>* :  匹配前一个表达式0次或多次。等价于 {0,}。</h6><p>例如，/bo*/会匹配 “A ghost boooooed” 中的 ‘booooo’ 和 “A bird warbled” 中的 ‘b’，但是在 “A goat grunted” 中将不会匹配任何东西。</p>
<h6 id="匹配前面一个表达式1次或者多次。等价于-1-。"><a href="#匹配前面一个表达式1次或者多次。等价于-1-。" class="headerlink" title="+ :  匹配前面一个表达式1次或者多次。等价于 {1,}。"></a>+ :  匹配前面一个表达式1次或者多次。等价于 {1,}。</h6><p>例如，/a+/匹配了在 “candy” 中的 ‘a’，和在 “caaaaaaandy” 中所有的 ‘a’。</p>
<h6 id="匹配前面一个表达式0次或者1次。等价于-0-1-。"><a href="#匹配前面一个表达式0次或者1次。等价于-0-1-。" class="headerlink" title="?  : 匹配前面一个表达式0次或者1次。等价于 {0,1}。"></a>?  : 匹配前面一个表达式0次或者1次。等价于 {0,1}。</h6><p>例如，/e?le?/ 匹配 “angel” 中的 ‘el’，和 “angle” 中的 ‘le’ 以及”oslo’ 中的’l’。<br>如果紧跟在任何量词 *、 +、? 或 {} 的后面，将会使量词变为非贪婪的（匹配尽量少的字符），和缺省使用的贪婪模式（匹配尽可能多的字符）正好相反。</p>
<p>例如，对 “123abc” 应用 /\d+/ 将会返回 “123”，如果使用 /\d+?/,那么就只会匹配到 “1”。<br>还可以运用于先行断言，如本表的 x(?=y) 和 x(?!y) 条目中所述。</p>
<h6 id="（小数点）匹配除换行符之外的任何单个字符。"><a href="#（小数点）匹配除换行符之外的任何单个字符。" class="headerlink" title=".  :（小数点）匹配除换行符之外的任何单个字符。"></a>.  :（小数点）匹配除换行符之外的任何单个字符。</h6><p>例如，/.n/将会匹配 “nay, an apple is on the tree” 中的 ‘an’ 和 ‘on’，但是不会匹配 ‘nay’。</p>
<h6 id="d-匹配一个数字。等价于-0-9-。"><a href="#d-匹配一个数字。等价于-0-9-。" class="headerlink" title="\d : 匹配一个数字。等价于[0-9]。"></a>\d : 匹配一个数字。等价于[0-9]。</h6><p>例如， /\d/ 或者 /[0-9]/ 匹配”B2 is the suite number.”中的’2’。</p>
<h6 id="s-匹配一个空白字符，包括空格、制表符、换页符和换行符。"><a href="#s-匹配一个空白字符，包括空格、制表符、换页符和换行符。" class="headerlink" title="\s :匹配一个空白字符，包括空格、制表符、换页符和换行符。"></a>\s :匹配一个空白字符，包括空格、制表符、换页符和换行符。</h6><p>等价于[ \f\n\r\t\v\u00a0\u1680\u180e\u2000\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]。<br>例如, /\s\w*/ 匹配”foo bar.”中的’ bar’。</p>
<h6 id="w-匹配一个单字字符（字母、数字或者下划线）。等价于-A-Za-z0-9-。"><a href="#w-匹配一个单字字符（字母、数字或者下划线）。等价于-A-Za-z0-9-。" class="headerlink" title="\w : 匹配一个单字字符（字母、数字或者下划线）。等价于[A-Za-z0-9_]。"></a>\w : 匹配一个单字字符（字母、数字或者下划线）。等价于[A-Za-z0-9_]。</h6><p>例如, /\w/ 匹配 “apple,” 中的 ‘a’，”$5.28,”中的 ‘5’ 和 “3D.” 中的 ‘3’。</p>
<h4 id="使用正则表达式"><a href="#使用正则表达式" class="headerlink" title="使用正则表达式"></a>使用正则表达式</h4><p>正则表达式可以被用于<code>RegExp</code>的<a href="https://developer.mozilla.org/zh-CN/docs/JavaScript/Reference/Global_Objects/RegExp/exec" target="_blank" rel="noopener"><code>exec</code></a>和<a href="https://developer.mozilla.org/zh-CN/docs/JavaScript/Reference/Global_Objects/RegExp/test" target="_blank" rel="noopener"><code>test</code></a>方法以及 <a href="https://developer.mozilla.org/zh-CN/docs/JavaScript/Reference/Global_Objects/String" target="_blank" rel="noopener"><code>String</code></a>的<a href="https://developer.mozilla.org/zh-CN/docs/JavaScript/Reference/Global_Objects/String/match" target="_blank" rel="noopener"><code>match</code></a>、<a href="https://developer.mozilla.org/zh-CN/docs/JavaScript/Reference/Global_Objects/String/replace" target="_blank" rel="noopener"><code>replace</code></a>、<a href="https://developer.mozilla.org/zh-CN/docs/JavaScript/Reference/Global_Objects/String/search" target="_blank" rel="noopener"><code>search</code></a>和<a href="https://developer.mozilla.org/zh-CN/docs/JavaScript/Reference/Global_Objects/String/split" target="_blank" rel="noopener"><code>split</code></a>方法</p>
<table>
<thead>
<tr>
<th><code>exec</code></th>
<th>一个在字符串中执行查找匹配的RegExp方法，它返回一个数组（未匹配到则返回null）。</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>test</code></td>
<td>一个在字符串中测试是否匹配的RegExp方法，它返回true或false。</td>
</tr>
<tr>
<td><code>match</code></td>
<td>一个在字符串中执行查找匹配的String方法，它返回一个数组或者在未匹配到时返回null。</td>
</tr>
<tr>
<td><code>search</code></td>
<td>一个在字符串中测试匹配的String方法，它返回匹配到的位置索引，或者在失败时返回-1。</td>
</tr>
<tr>
<td><code>replace</code></td>
<td>一个在字符串中执行查找匹配的String方法，并且使用替换字符串替换掉匹配到的子字符串。</td>
</tr>
<tr>
<td><code>split</code></td>
<td>一个使用正则表达式或者一个固定字符串分隔一个字符串，并将分隔后的子字符串存储到数组中的String方法。</td>
</tr>
</tbody>
</table>
<p>当你想要知道在一个字符串中的一个匹配是否被找到，你可以使用test或search方法；</p>
<p>想得到更多的信息（但是比较慢）则可以使用exec或match方法。</p>
<p>如果你使用exec或match方法并且匹配成功了，那么这些方法将返回一个数组并且更新相关的正则表达式对象的属性和预定义的正则表达式对象。如果匹配失败，那么exec方法返回null（也就是false）</p>
<h4 id="来做做如下实例"><a href="#来做做如下实例" class="headerlink" title="来做做如下实例"></a>来做做如下实例</h4><p>一个函数<code>isValidUsername(str)</code>，判断用户输入的是不是合法的用户名（长度6-20个字符，只能包括字母、数字、下划线）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isValidUsername</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    reg = <span class="regexp">/^\w&#123;6,20&#125;$/</span></span><br><span class="line">    <span class="keyword">return</span> reg.test(str)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(isValidUsername(<span class="string">'x_wu_ya'</span>))</span><br></pre></td></tr></table></figure>
<p>一个函数<code>isPhoneNum(str)</code>，判断用户输入的是不是手机号</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPhoneNum</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    reg = <span class="regexp">/^1[3578]\d&#123;9&#125;$/</span></span><br><span class="line">    <span class="keyword">return</span> reg.test(str)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(isPhoneNum(<span class="string">'131203456112'</span>))</span><br></pre></td></tr></table></figure>
<p>写一个函数<code>isEmail(str)</code>，判断用户输入的是不是邮箱</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isEmail</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    reg = <span class="regexp">/^\w+@.+(.com)$/</span></span><br><span class="line">    <span class="keyword">return</span> reg.test(str)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(isEmail(<span class="string">'xwu@qq.com'</span>))</span><br></pre></td></tr></table></figure>
<p>参考： <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions#note" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions#note</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/03/HEXO教程/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wuer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wuer">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/03/HEXO教程/" itemprop="url">HEXO教程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-03T16:18:30+08:00">
                2018-11-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="注意：如果你使用的是-Windows-系统，Hexo-很容易安装不成功"><a href="#注意：如果你使用的是-Windows-系统，Hexo-很容易安装不成功" class="headerlink" title="注意：如果你使用的是 Windows 系统，Hexo 很容易安装不成功"></a>注意：如果你使用的是 Windows 系统，Hexo 很容易安装不成功</h4><p>如果不成功，二选一：</p>
<ol>
<li>你就放弃 Hexo，使用简书、知乎、segmentfault、掘金等工具写博客。</li>
<li>你就放弃 Windows，改用 Linux，<a href="https://xiedaimala.com/tasks/11ad5683-7e18-4883-879d-8425e6a6ceb7" target="_blank" rel="noopener">教程</a></li>
</ol>
<h4 id="使用-Hexo-GitHub-可以轻松搞出一个好看的博客"><a href="#使用-Hexo-GitHub-可以轻松搞出一个好看的博客" class="headerlink" title="使用 Hexo + GitHub 可以轻松搞出一个好看的博客"></a>使用 Hexo + GitHub 可以轻松搞出一个好看的博客</h4><h5 id="以下是步骤"><a href="#以下是步骤" class="headerlink" title="以下是步骤"></a>以下是步骤</h5><ol>
<li><p>进入一个安全的目录，比如 <code>cd ~/Desktop</code> 或者 <code>cd ~/Documents</code>，别在根目录 / 瞎搞。以后所有的教程第一步都是「进入一个安全的目录，别在根目录瞎搞」，只有 ~ 里面的目录是你能碰的！</p>
</li>
<li><p>在 GitHub 上新建一个空 repo，repo 名称是「你的用户名.github.io」（注意个用户名是你的GitHub用户名，不是你的电脑用户名）</p>
</li>
<li><p><code>npm install -g hexo-cli</code>，安装 Hexo</p>
</li>
<li><p><code>hexo init myBlog</code></p>
</li>
<li><p><code>cd myBlog</code></p>
</li>
<li><p><code>npm i</code></p>
</li>
<li><p><code>hexo new 开博大吉</code>  你会看到一个md文件的路径</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-f4bc8c7d1bb875b7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img.jpg"></p>
<p>Windows 的路径中的 \ 需要变成 / 才行哦</p>
</li>
<li><p><code>start xxxxxxxxxxxxxxxxxxx.md</code>，编辑这个 md 文件，内容自己想（Ubuntu 系统用 <code>xdg-open xxxxxxxxxxxxxxxxxxx.md</code> 命令）</p>
</li>
<li><p><code>start _config.yml</code>，编辑网站配置</p>
<ul>
<li><p>把第 6 行的 title 改成你想要的名字</p>
</li>
<li><p>把第 9 行的 author 改成你的大名</p>
</li>
<li><p>把最后一行的 type 改成 <code>type: git</code></p>
</li>
<li><p>在最后一行后面新增一行，左边与 type 平齐，加上一行 <code>repo: 仓库地址</code> （请将仓库地址改为「你的用户名.github.io」对应的仓库地址，仓库地址以 <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>: 开头你知道吧？不知道？不知道的话现在你知道了）</p>
</li>
<li><p>第 4 步的 repo: 后面有个空格，不要眼瞎。</p>
</li>
</ul>
</li>
<li><p><code>npm install hexo-deployer-git --save</code>，安装 git 部署插件</p>
</li>
<li><p><code>hexo deploy</code></p>
</li>
<li><p>进入「你的用户名.github.io」对应的 repo，打开 GitHub Pages 功能，如果已经打开了，你应该会看到一个预览链接</p>
</li>
<li><p>用浏览器访问「预览链接/index.html」就应该看到了你的博客！（GitHub Pages 存在延迟，如果没看到，过三分钟再刷新看看）</p>
</li>
</ol>
<h5 id="第二篇博客"><a href="#第二篇博客" class="headerlink" title="第二篇博客"></a>第二篇博客</h5><ol>
<li><code>hexo new 第二篇博客</code></li>
<li>复制显示的路径，使用 <code>start 路径</code> 来编辑它</li>
<li><code>hexo generate</code></li>
<li><code>hexo deploy</code></li>
</ol>
<h5 id="换主题"><a href="#换主题" class="headerlink" title="换主题"></a>换主题</h5><ol>
<li><a href="https://github.com/hexojs/hexo/wiki/Themes" target="_blank" rel="noopener">https://github.com/hexojs/hexo/wiki/Themes</a> 上面有主题合集</li>
<li>随便找一个主题，进入主题的 GitHub 首页，比如我找的是 <a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">https://github.com/iissnan/hexo-theme-next</a></li>
<li>复制它的 SSH 地址或 HTTPS 地址，假设地址为 <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:iissnan/hexo-theme-next.git</li>
<li><code>cd themes</code></li>
<li><code>git clone git@github.com:iissnan/hexo-theme-next.git</code></li>
<li><code>cd ..</code></li>
<li>将 _config.yml 的第 75 行改为 <code>theme: hexo-theme-next</code>，保存</li>
<li><code>hexo generate</code></li>
<li><code>hexo deploy</code></li>
<li>等一分钟，然后刷新你的博客页面，你会看到一个新的外观。如果不喜欢这个主题，就回到第 1 步，重选一个主题。</li>
</ol>
<h5 id="上传源代码"><a href="#上传源代码" class="headerlink" title="上传源代码"></a>上传源代码</h5><p>注意「你的用户名.github.io」上保存的只是你的博客，并没有保存「生成博客的程序代码」，你需要再创建一个名为 blog-generator 的空仓库，用来保存 myBlog 里面的「生成博客的程序代码」。</p>
<ol>
<li><p>在 GitHub 创建 blog-generator 空仓库</p>
<p><img src="https://upload-images.jianshu.io/upload_images/9375265-41320af865b4e459.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="res.jpg"></p>
<p>2.按照截图中的命令执行即可，记住，别用 HTTPS 地址。</p>
</li>
</ol>
<p>这样一来，你的博客发布在了「你的用户名.github.io」而你的「生成博客的程序代码」发布在了 blog-generator。所有数据万无一失，你就不会因为误删 myBlog 目录而痛哭了。</p>
<p>以后每次 hexo deploy 完之后，博客就会更新；然后你还要要 add / commit /push 一下「生成博客的程序代码」，以防万一。</p>
<p>这个 blog-generator 就是用来生成博客的程序，而「你的用户名.github.io」仓库就是你的博客页面。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Wuer</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">24</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wuer</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
